<!DOCTYPE HTML>
<html lang="en">
<head>
<title>StringReplace - Syntax &amp; Usage | AutoHotkey v1</title>
<meta name="description" content="The StringReplace command replaces the specified substring with a new string." />
<meta name="ahk:equiv-v2" content="lib/StrReplace.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>StringReplace</h1>
<p>Replaces the specified substring with a new string.</p>
<p class="warning"><strong>Deprecated:</strong> This command is not recommended for use in new scripts. Use the <a href="StrReplace.htm">StrReplace</a> function instead.</p>
<pre class="Syntax"><span class="func">StringReplace</span>, OutputVar, InputVar, SearchText <span class="optional">, ReplaceText, ReplaceAll</span></pre>

<h2 id="Parameters">Parameters</h2>
<dl>

  <dt>OutputVar</dt>
  <dd>The name of the output variable in which to store the result of the replacement process.</dd>

  <dt>InputVar</dt>
  <dd>The name of the input variable whose contents will be read from. Do not enclose the name in percent signs unless you want the contents of the variable to be used as the name.</dd>

  <dt>SearchText</dt>
  <dd>The string to search for. Matching is not case-sensitive unless <a href="StringCaseSense.htm">StringCaseSense</a> has been turned on.</dd>

  <dt>ReplaceText</dt>
  <dd>If blank or omitted, <em>SearchText</em> will be replaced with blank (empty), meaning it will be omitted from <em>OutputVar</em>. Otherwise, specify the string to replace <em>SearchText</em> with.</dd>
  
  <dt>ReplaceAll</dt>
  <dd>
    <p>If blank or omitted, only the first occurrence of <em>SearchText</em> will be replaced. Otherwise, specify 1, A, or All to replace all occurrences.</p>
    <p>Specify the word <strong>UseErrorLevel</strong> to store in <a href="../misc/ErrorLevel.htm">ErrorLevel</a> the number of occurrences replaced (0 if none). UseErrorLevel implies "All".</p>
  </dd>

</dl>

<h2 id="ErrorLevel">ErrorLevel</h2>
<p>When the last parameter is UseErrorLevel, <a href="../misc/ErrorLevel.htm">ErrorLevel</a> is given the number occurrences replaced (0 if none). Otherwise, ErrorLevel is set to 1 if <em>SearchText</em> is not found within <em>InputVar</em>, or 0 if it is found.</p>

<h2 id="Remarks">Remarks</h2>
<p>For this and all other commands, <em>OutputVar</em> is allowed to be the same variable as <em>InputVar</em>.</p>
<p>The built-in variables <strong>A_Space</strong> and <strong>A_Tab</strong> contain a single space and a single tab character, respectively. They are useful when searching for spaces and tabs alone or at the beginning or end of <em>SearchText</em>.</p>
<p><span class="ver">[v1.0.45+]</span>: The AllSlow option became obsolete due to improvements to performance and memory utilization. Although it may still be specified, it has no effect.</p>

<h2 id="Related">Related</h2>
<p><a href="StrReplace.htm">StrReplace()</a>, <a href="RegExReplace.htm">RegExReplace()</a>, <a href="IfInString.htm">IfInString</a>, <a href="StringCaseSense.htm">StringCaseSense</a>, <a href="StringLeft.htm">StringLeft</a>, <a href="StringLeft.htm">StringRight</a>, <a href="StringMid.htm">StringMid</a>, <a href="StringTrimLeft.htm">StringTrimLeft</a>, <a href="StringTrimLeft.htm">StringTrimRight</a>, <a href="StringLen.htm">StringLen</a>, <a href="StringLower.htm">StringLower</a>, <a href="StringLower.htm">StringUpper</a>, <a href="StringGetPos.htm">StringGetPos</a>,  <a href="IfIs.htm">If Var is [not] Type</a></p>

<h2 id="Examples">Examples</h2>
<div class="ex" id="ExClipboard">
<p><a class="ex_number" href="#ExClipboard"></a> Removes all CR-LF pairs from the clipboard contents.</p>
<pre>StringReplace, Clipboard, Clipboard, `r`n, , All</pre>
</div>

<div class="ex" id="ExVar">
<p><a class="ex_number" href="#ExVar"></a> Replaces all spaces with pluses.</p>
<pre>StringReplace, NewStr, OldStr, %A_Space%, +, All</pre>
</div>

<div class="ex" id="ExRemoveBlankLines">
<p><a class="ex_number" href="#ExRemoveBlankLines"></a> Removes all blank lines from the text in a variable.</p>
<pre>Loop
{
    StringReplace, MyString, MyString, `r`n`r`n, `r`n, UseErrorLevel
    if (ErrorLevel = 0)  <em>; No more replacements needed.</em>
        break
}</pre>
</div>

</body>
</html>