<!DOCTYPE HTML>
<html lang="en">
<head>
<title>ControlGetIndex - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The ControlGetIndex function returns the index of the currently selected entry or tab in a ListBox, ComboBox or Tab control." />
<meta name="ahk:equiv-v1" content="lib/ControlGet.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetIndex</h1>

<p>Returns the index of the currently selected entry or tab in a ListBox, ComboBox or Tab control.</p>

<pre class="Syntax">Index := <span class="func">ControlGetIndex</span>(Control <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span>)</pre>

<h2 id="Parameters">Parameters</h2>
<dl>
    <dt>Control</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a>, <a href="../Concepts.htm#numbers">Integer</a> or <a href="../Objects.htm">Object</a></p>
        <p>The control's ClassNN, text or HWND, or an object with a <code>Hwnd</code> property. For details, see <a href="Control.htm#Parameter">The Control Parameter</a>.</p>
    </dd>
    <dt>WinTitle</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a>, <a href="../Concepts.htm#numbers">Integer</a> or <a href="../Objects.htm">Object</a></p>
        <p>A window title or other criteria identifying the target window. See <a href="../misc/WinTitle.htm">WinTitle</a>.</p>
    </dd>
    <dt>WinText</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a></p>
        <p>If present, this parameter must be a substring from a single text element of the target window (as revealed by the included Window Spy utility). Hidden text elements are detected if <a href="DetectHiddenText.htm">DetectHiddenText</a> is ON.</p>
    </dd>
    <dt>ExcludeTitle</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a></p>
        <p>Windows whose titles include this value will not be considered.</p>
    </dd>
    <dt>ExcludeText</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a></p>
        <p>Windows whose text include this value will not be considered.</p>
    </dd>
</dl>

<h2 id="Return_Value">Return Value</h2>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This function returns the index of the currently selected entry or tab. The first entry or tab is 1, the second is 2, etc. If no entry or tab is selected, the return value is 0.</p>

<h2 id="Error_Handling">Error Handling</h2>
<p>A <a href="ErrorObj.htm#TargetError">TargetError</a> is thrown if the window or control could not be found, or if the control's class name does not contain "Combo", "List" or "Tab".</p>
<p>An <a href="ErrorObj.htm#OSError">OSError</a> is thrown if a message could not be sent to the control.</p>

<h2 id="Remarks">Remarks</h2>
<p>To instead discover how many tabs (pages) exist in a tab control, follow this example:</p>
<pre>TabCount := <a href="SendMessage.htm">SendMessage</a>(0x1304,,, "SysTabControl321", WinTitle)  <em>; 0x1304 is TCM_GETITEMCOUNT.</em></pre>
<p>Window titles and text are case sensitive. Hidden windows are not detected unless <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> has been turned on.</p>

<h2 id="Related">Related</h2>
<p><a href="ControlChooseIndex.htm">ControlChooseIndex</a>, <a href="ControlGetChoice.htm">ControlGetChoice</a>, <a href="ControlChooseString.htm">ControlChooseString</a>, <a href="GuiControlObj.htm#Value">Value property (GuiControl object)</a>, <a href="GuiControlObj.htm#Choose">Choose method (GuiControl object)</a>, <a href="Control.htm">Control functions</a></p>

<h2 id="Examples">Examples</h2>

<div class="ex" id="ExTab">
<p><a class="ex_number" href="#ExTab"></a> Retrieves the active tab number of the first Tab control.</p>
<pre>
WhichTab := ControlGetIndex("SysTabControl321", "Some Window Title")
MsgBox "Tab #" WhichTab " is active."
</pre>
</div>

</body>
</html>
