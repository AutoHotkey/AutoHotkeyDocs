<!DOCTYPE HTML>
<html lang="en">
<head>
<title>IniRead - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The IniRead function reads a value, section or list of section names from a standard format .ini file." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>IniRead</h1>

<p>Reads a value, section or list of section names from a standard format .ini file.</p>

<pre class="Syntax">Value := <span class="func">IniRead</span>(Filename, Section, Key <span class="optional">, Default</span>)
Section := <span class="func">IniRead</span>(Filename, Section)
SectionNames := <span class="func">IniRead</span>(Filename)</pre>
<h2>Parameters</h2>
<dl>

  <dt>Filename</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>The name of the .ini file, which is assumed to be in <a href="../Variables.htm#WorkingDir">A_WorkingDir</a> if an absolute path isn't specified.</p>
  </dd>

  <dt>Section</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>The section name in the .ini file, which is the heading phrase that appears in square brackets (do not include the brackets in this parameter).</p>
  </dd>

  <dt>Key</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>The key name in the .ini file.</p>
  </dd>

  <dt>Default</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>The value to return if the requested key is not found. If omitted, it defaults to an empty string.</p>
      <p>This parameter is not used if <i>Key</i> is omitted.</p>
      </dd>

</dl>

<h2>Return Value</h2>
<p>Type: <a href="../Concepts.htm#strings">String</a></p>
<p>This function returns the actual value of the specified key. If the value cannot be retrieved, the default value indicated by the <em>Default</em> parameter is returned.</p>
<p>If the <em>Key</em> parameter is omitted, this function returns an entire section. Comments and empty lines are omitted. Only the first 65,533 characters of the section are retrieved.</p>
<p>If the <em>Key</em> and <em>Section</em> parameters are omitted, this function returns a linefeed (<code>`n</code>) delimited list of section names.</p>

<h2>ErrorLevel</h2>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> is set to 1 if there was a problem or 0 otherwise.</p>
<h2>Remarks</h2>
<p>The operating system automatically omits leading and trailing spaces/tabs from the retrieved string. To prevent this, enclose the string in single or double quote marks. The outermost set of single or double quote marks is also omitted, but any spaces inside the quote marks are preserved.</p>
<p>Values longer than 65,535 characters are likely to yield inconsistent results.</p>
<p>A standard ini file looks like:</p>
<pre>[SectionName]
Key=Value</pre>
<p><b>Unicode:</b> IniRead and IniWrite rely on the external functions <a href="http://msdn.microsoft.com/en-us/library/ms724353.aspx">GetPrivateProfileString</a> and <a href="http://msdn.microsoft.com/en-us/library/ms725501.aspx">WritePrivateProfileString</a> to read and write values. These functions support Unicode only in UTF-16 files; all other files are assumed to use the system's default ANSI code page.</p>
<h2>Related</h2>
<p><a href="IniDelete.htm">IniDelete</a>, <a href="IniWrite.htm">IniWrite</a>, <a href="RegRead.htm">RegRead</a>, <a href="LoopRead.htm">file-reading loop</a>, <a href="FileRead.htm">FileRead</a></p>
<h2>Examples</h2>
<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a></p>
<pre>Value := IniRead("C:\Temp\myfile.ini", "section2", "key")
MsgBox "The value is " Value</pre>
</div>

</body>
</html>
