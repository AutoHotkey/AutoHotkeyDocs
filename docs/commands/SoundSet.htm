<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>SoundSet</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>SoundSet</h1>

<p>Changes various settings of a sound device (master mute, master volume, etc.)</p>

<pre class="Syntax">SoundSet, NewSetting [, ComponentType, ControlType, DeviceNumber]</pre>
<h3>Parameters</h3>
<table class="info">
  <tr>
    <td width="15%">NewSetting</td>
    <td width="85%"><p>Percentage number between -100 and 100 inclusive (it can be a floating point number or <a href="../Variables.htm#Expressions">expression</a>). If the number begins with a plus or minus sign, the <strong>current setting </strong> will be adjusted up or down by the indicated amount. Otherwise, the setting will be set explicitly to the level indicated by <em>NewSetting</em>.</p>
      <p>For <em>ControlTypes</em> with only two possible settings -- namely ONOFF, MUTE, MONO, LOUDNESS, STEREOENH, and BASSBOOST -- any positive number will turn on the setting and a zero will turn it off. However, if the number begins with a plus or minus sign, the  setting  will be toggled (set to the opposite of its current state).</p></td>
  </tr>
  <tr>
    <td>ComponentType</td>
    <td><p>If omitted or blank, it defaults to the word MASTER. Otherwise, it can be one of the following words: MASTER (synonymous with SPEAKERS), DIGITAL, LINE, MICROPHONE, SYNTH, CD, TELEPHONE, PCSPEAKER, WAVE, AUX, ANALOG, HEADPHONES, or N/A. If the sound device lacks the specified <em>ComponentType</em>, ErrorLevel will indicate the problem.</p>
      <p>The component labeled Auxiliary in some mixers might be accessible as ANALOG rather than AUX.</p>
    <p>If a device has more than one instance of <em>ComponentType</em> (two of type LINE, for example), usually the first contains the playback settings and the second contains the recording settings. To access an instance other than the first, append a colon and a number to this parameter. For example: <code>Analog:2</code> is the second instance of the analog component.</p></td>
  </tr>
  <tr>
    <td>ControlType</td>
    <td><p>If omitted or blank, it defaults to VOLUME. Otherwise, it can be one of the following words: VOLUME (or VOL), ONOFF, MUTE, MONO, LOUDNESS, STEREOENH, BASSBOOST, PAN, QSOUNDPAN, BASS, TREBLE, EQUALIZER, or the number of a valid control type (see <a href="../scripts/Soundcard.htm">soundcard analysis script</a>). If the specified <em>ComponentType</em> lacks the specified <em>ControlType</em>, ErrorLevel will indicate the problem.</p>
    <p><strong>Note:</strong> sound devices usually support only VOLUME (or VOL) and MUTE, although others may be available depending on Windows and the sound device.</p></td>
  </tr>
  <tr>
    <td>DeviceNumber</td>
    <td>If this parameter is omitted, it defaults to 1 (the first sound device), or on Windows Vista or above, the system's default device for playback. Explicitly specify a number to operate upon a specific sound device. This parameter can be an <a href="../Variables.htm#Expressions">expression</a>. The <a href="../scripts/Soundcard.htm">soundcard analysis script</a> may help determine which index to use.</td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> This command is able to throw an exception on failure. For more information, see <a href="Catch.htm#RuntimeErrors">Runtime Errors</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> is set to 0 if the command succeeded. Otherwise, it is set to one of the following phrases:</p>
<table class="info" style="width:436px">
  <tr>
    <td width="426">Invalid Control Type or Component Type</td>
  </tr>
  <tr>
    <td>Can't Open Specified Mixer</td>
  </tr>
  <tr>
    <td>Mixer Doesn't Support This Component Type</td>
  </tr>
  <tr>
    <td>Mixer Doesn't Have That Many of That Component Type</td>
  </tr>
  <tr>
    <td>Component Doesn't Support This Control Type</td>
  </tr>
  <tr>
    <td>Can't Get Current Setting</td>
  </tr>
  <tr>
    <td>Can't Change Setting</td>
  </tr>
</table>
<h3>Remarks</h3>
<p>A sound device may represent either a physical device, or one of its connectors (e.g., Speakers, Line In, Microphone). This is dependent upon Windows and the specific device.</p>
<p>For more functionality and finer grained control over audio, consider using the <a href="http://www.autohotkey.com/board/topic/21984-vista-audio-control-functions/">VA library</a>. It is also included with the <a href="../scripts/Soundcard.htm">soundcard analysis script</a>.</p>
<p>An alternative way to adjust the volume is to have the script send volume-control keystrokes to change the master volume for the entire system, such as in the example below:</p>
<pre>Send {Volume_Up}  <em>; Raise the master volume by 1 interval (typically 5%).</em>
Send {Volume_Down 3}  <em>; Lower the master volume by 3 intervals.</em>
Send {Volume_Mute}  <em>; Mute/unmute the master volume.</em></pre>
<p>To discover the capabilities of the sound devices (mixers) installed on the system -- such as the available component types and control types -- run the <a href="../scripts/Soundcard.htm">soundcard analysis script</a>.</p>
<p>When SoundSet changes the volume of a component, all of that component's channels (e.g. left and right) are set to the same level. In other words, any off-center &quot;balance&quot; that may have been set previously is lost. This can be avoided for the WAVE component by using <a href="SoundSetWaveVolume.htm">SoundSetWaveVolume</a> instead, which attempts to preserve the existing balance when changing the volume level.</p>
<p>Use <a href="SoundGet.htm">SoundGet</a> to retrieve the current value of a setting.</p>
<h3>Related</h3>
<p><a href="SoundGet.htm">SoundGet</a>, <a href="SoundGetWaveVolume.htm">SoundGetWaveVolume</a>, <a href="SoundSetWaveVolume.htm">SoundSetWaveVolume</a>, <a href="SoundPlay.htm">SoundPlay</a></p>
<h3>Examples</h3>
<pre class="NoIndent"><em>; BASIC EXAMPLES:</em>
SoundSet, 50  <em>; Set the master volume to 50%</em>
SoundSet +10  <em>; Increase master volume by 10%</em>
SoundSet -10  <em>; Decrease master volume by 10%</em>
SoundSet, 1, Microphone, mute  <em>; mute the microphone</em>
SoundSet, +1, , mute  <em>; Toggle the master mute (set it to the opposite state)</em>
SoundSet, +20, Master, bass  <em>; Increase bass level by 20%.</em>
if ErrorLevel
    MsgBox, The BASS setting is not supported for MASTER.</pre>

</body>
</html>
