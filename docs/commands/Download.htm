<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Download</title>
<meta name="description" content="Download any type of file via Download in this free scripting language. e.g. Download, http://www.anyorg.org/File.htm, c:\File.htm">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>Download</h1>

<p>Downloads a file from the Internet.</p>

<pre class="Syntax">Download, URL, Filename </pre>
<h3>Parameters</h3>
<dl>

  <dt>URL</dt>
  <dd><p>URL of the file to download. For example, http://someorg.org might retrieve the welcome page for that organization. </p></dd>

  <dt>Filename</dt>
  <dd><p><strong>Download to a file</strong>: Specify the name of the file to be created locally, which is assumed to be in <a href="../Variables.htm#WorkingDir">%A_WorkingDir%</a> if an absolute path isn't specified. Any existing file will be <strong>overwritten</strong> by the new file.</p>
    <p><strong>Download to a variable</strong>: See the example below. For alternative methods, see the following forum topic: <a href="http://www.autohotkey.com/forum/topic10466.html">www.autohotkey.com/forum/topic10466.html</a></p></dd>

</dl>

<h3>ErrorLevel</h3>
<p>This command is able to throw an exception on failure. For more information, see <a href="Catch.htm#RuntimeErrors">Runtime Errors</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> is set to 1 if there was a problem or 0 otherwise.</p>
<h3>Remarks</h3>
<p>The download might appear to succeed even when the remote file doesn't exist. This is because many web servers send an error page instead of the missing file. This error page is what will be saved in place of <em>Filename</em>.</p>
<p>Firewalls or the presence of multiple network adapters may cause this function to fail. Also, some websites may block such downloads.</p>
<p><strong>Caching</strong>: By default, the URL is retrieved directly from the remote server (that is, never from Internet Explorer's cache). To permit caching, precede the URL with *0 followed by a space; for example: <em>*0 http://someorg.org</em>. The zero following the asterisk may be replaced by any valid dwFlags number; for details, search <a href="http://www.microsoft.com">www.microsoft.com</a> for  InternetOpenUrl.</p>
<p><strong>Proxies</strong>: If a proxy server has been configured in Microsoft Internet Explorer's settings, it will be used.</p>
<p><strong>FTP and Gopher</strong> URLS are also supported. For example:</p>
<pre>Download, ftp://example.com/home/My File.zip, C:\My Folder\My File.zip  <em>; Log in anonymously.</em>
Download, ftp://user:pass@example.com:21/home/My File.zip, C:\My Folder\My File.zip  <em>; Log in as a specific user.</em>
Download, ftp://user:pass@example.com/My Directory, C:\Dir Listing.html  <em>; Gets a directory listing in HTML format.</em></pre>

<h3>Related</h3>
<p><a href="FileRead.htm">FileRead</a>, <a href="FileCopy.htm">FileCopy</a></p>

<h3>Examples</h3>
<pre class="NoIndent">Download, http://l.autohotkey.net/version.txt, C:\AutoHotkey_L Latest Version.txt
Download, http://someorg.org/archive.zip, C:\SomeOrg's Archive.zip</pre>
<pre id="WHR" class="NoIndent"><em>; Example: Download text to a variable:</em>
whr := ComObjCreate("WinHttp.WinHttpRequest.5.1")
whr.Open("GET", "http://l.autohotkey.net/version.txt")
whr.Send()
version := whr.ResponseText
MsgBox % version
</pre>

</body>
</html>
