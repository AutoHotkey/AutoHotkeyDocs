<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>FileCreateShortcut</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>FileCreateShortcut</h1>

<p>Creates a shortcut (.lnk) file.</p>

<pre class="Syntax">FileCreateShortcut, Target, LinkFile [, WorkingDir, Args, Description, IconFile, ShortcutKey, IconNumber, RunState]</pre>
<h3>Parameters</h3>
<table class="info">
  <tr>
    <td width="15%"> Target </td>
    <td width="85%">Name of the file that the shortcut refers to, which should include an absolute path unless the file is integrated with the system (e.g. Notepad.exe). The file does not have to exist at the time the shortcut is created; in other words, shortcuts to invalid targets can be created.</td>
  </tr>
  <tr>
    <td>LinkFile</td>
    <td>Name of the shortcut file to be created, which is assumed to be in <a href="../Variables.htm#WorkingDir">%A_WorkingDir%</a> if an absolute path isn't specified. Be sure to include the <strong>.lnk</strong> extension. If the file already exists, it will be overwritten.</td>
  </tr>
  <tr>
    <td>WorkingDir</td>
    <td>Directory that will become <em>Target's</em> current working directory when the shortcut is launched. If blank or omitted, the shortcut will have a blank &quot;Start in&quot; field and the system will provide a default working directory when the shortcut  is launched.</td>
  </tr>
  <tr>
    <td>Args</td>
    <td>Parameters that will be passed to <em>Target</em> when it is launched. Separate parameters with spaces. If a parameter contains spaces, enclose it in double quotes.</td>
  </tr>
  <tr>
    <td>Description</td>
    <td>Comments that describe the shortcut (used by the OS to display a tooltip, etc.)</td>
  </tr>
  <tr>
    <td>IconFile</td>
    <td>The full path and name of the icon to be displayed for <em>LinkFile</em>.  It must either be an ico file or the very first icon of an EXE or DLL.</td>
  </tr>
  <tr>
    <td>ShortcutKey</td>
    <td><p>A single letter, number, or the name of a single key from the <a href="../KeyList.htm">key list</a> (mouse buttons and other non-standard keys might not be supported). <strong>Do not</strong> include modifier symbols. Currently, all shortcut keys are created as CTRL+ALT shortcuts. For example, if the letter B is specified for this parameter, the shortcut key will be CTRL-ALT-B.</p>
    <p>For Windows 9x: A reboot might be required to get the shortcut key into effect. Alternatively, you can open the properties dialog for the shortcut and recreate the shortcut key to get it into effect immediately.</p></td>
  </tr>
  <tr>
    <td>IconNumber</td>
    <td>To use an icon in <em>IconFile</em> other than the first, specify that number here (can be an <a href="../Variables.htm#Expressions">expression</a>). For example, 2 is the second icon.</td>
  </tr>
  <tr>
    <td>RunState</td>
    <td><p>To have <em>Target</em> launched minimized or maximized, specify one of the following digits:</p>
      <p>1 - Normal (this is the default)<br>
3 - Maximized<br>
7 - Minimized</p>    </td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> This command is able to throw an exception on failure. For more information, see <a href="Catch.htm#RuntimeErrors">&quot;Runtime errors&quot;.</a></p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> is set to 1 if there was a problem or 0 otherwise.</p>
<h3>Remarks</h3>
<p><em>Target</em> might not need to include a path if the target file resides in one of the folders listed in the system's PATH environment variable. </p>
<p>The <em>ShortcutKey</em> of a newly created shortcut will have no effect unless the shortcut file resides on the desktop or somewhere in the Start Menu. If the <em>ShortcutKey</em> you choose is already in use, your new shortcut takes precedence.</p>
<p>An alternative way to create a shortcut to a URL is the following example, which creates a special URL shortcut. Change the first two parameters to suit your preferences:<br>
<a href="IniWrite.htm">IniWrite</a>, http://www.google.com, C:\My Shortcut.url, InternetShortcut, URL</p>
<p>The following may be optionally added to assign an icon to the above:<br>
<a href="IniWrite.htm">IniWrite</a>, &lt;IconFile&gt;, C:\My Shortcut.url, InternetShortcut, IconFile<br>
<a href="IniWrite.htm">IniWrite</a>, 0, C:\My Shortcut.url, InternetShortcut, IconIndex</p>
<p>In the above, replace 0 with the index of the icon (0 is used for the first icon) and replace &lt;IconFile&gt; with a URL, EXE, DLL, or ICO file. Examples: C:\Icons.dll, C:\App.exe, http://www.somedomain.com/ShortcutIcon.ico</p>
<p>The operating system will treat a .URL file created by the above as a real shortcut even though it is a plain text file rather than a .LNK file.</p>
<h3>Related</h3>
<p><a href="FileGetShortcut.htm">FileGetShortcut</a>, <a href="FileAppend.htm">FileAppend</a></p>
<h3>Example</h3>
<pre class="NoIndent"><em>; The letter &quot;i&quot; in the last parameter makes the shortcut key be Ctrl-Alt-I:</em>
FileCreateShortcut, Notepad.exe, %A_Desktop%\My Shortcut.lnk, C:\, &quot;%A_ScriptFullPath%&quot;, My Description, C:\My Icon.ico, i</pre>

</body>
</html>
